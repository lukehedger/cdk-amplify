version: 1
frontend:
  artifacts:
    baseDirectory: app/public
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
  customHeaders:
    - headers:
      - key: Content-Security-Policy
        value: default-src self
      - key: Strict-Transport-Security
        value: max-age=31536000; includeSubDomains
      - key: X-Content-Type-Options
        value: nosniff
      - key: X-Frame-Options
        value: SAMEORIGIN
      - key: X-XSS-Protection
        value: 1; mode=block
    pattern: '**/*'
  phases:
    preBuild:
      commands:
        - npm install --prefix app
    build:
      commands:
        - npm run build --prefix app
test:
  artifacts:
    baseDirectory: app/cypress
    files:
      - '**/*.mp4'
      - '**/*.png'
  cache:
    paths:
      - node_modules/**/*
  phases:
    preTest:
      commands:
        - npm install --prefix app
    test:
      commands:
        - npm test --prefix app
